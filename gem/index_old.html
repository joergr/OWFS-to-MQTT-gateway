<!DOCTYPE html>
<html lang="en">
<head>
	<title>jOnewire-MQTT gateway config</title>
	<meta charset="utf-8" />
	<style>
		html {
			margin: 0;
			padding: 0;
			font-size: 62.5%;
		}

		body {
			max-width: 800px;
			min-width: 300px;
			margin: 0 auto;
			padding: 20px 10px;
			font-size: 14px;
			font-size: 1.4em;
		}

		.err {
			color: red;
			text-align: left;
		}

		button {
			width: 100px;
		}

		h1 {
			font-size: 1.8em;
		}

		.left {
			text-align: left;
		}

		.inp {
			width: 100%;
		}

		.dirlist {
			overflow: auto;
			border: 1px solid silver;
			min-height: 100px;
			max-height: 200px;
		}
	</style>
	<link rel="stylesheet" href="dist/themes/default/style.min.css" />
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
	<script src="dist/jstree.min.js"></script>
	<script type="text/javascript">
		/*DIR*/

		function clickAdd() {
			var s = "?descr=" + $("#descr").val();
			s += "&item=" + $("#item").val();
			s += "&topic=" + $("#topic").val();
			document.location = s;
		}
		function clickDelete(topic) {
			if (confirm("Are you sure?")) document.location = "?cmd=delete&topic=" + topic;
		}
		function begin() {
			$("#item").on("click", function () { $('#evts').show(); });
			$("#topic").on("click", function () { $('#evts').hide(); });
			$("#descr").on("click", function () { $('#evts').hide(); });
			$('#evts_button').on("click", function () {
				var instance = $('#evts').jstree(true);
				instance.deselect_all();
				instance.select_node('1');
			});
			$('#evts')
				.hide()
				.on("changed.jstree", function (e, data) {
					if (data.selected.length) {
						var node = data.instance.get_node(data.selected[0]);
						$("#item").val(node.id);
						$("#evts").hide();
					}
				})
				.jstree({
					'core': {
						'data': dir
					}
				});
		}
	</script>
</head>
<body onload="begin()">
	<h1>Onewire - MQTT gateway</h1>
	<h2>Configuration Brænder</h2>
	<button onclick="document.location='/'">Refresh</button>
	<table>
		<tr><th class="left">item</th><th class="left">Topic subscript</th><th class="left">Description</th></tr>
		<!--LIST-->
		<tr>
			<td><input type="text" id="item" class="inp" value="%%ITEM%%" /></td>
			<td><input type="text" id="topic" class="inp" value="%%TOPIC%%" /></td>
			<td><input type="text" id="descr" class="inp" value="%%DESC%%" /></td>
			<td><button onclick="clickAdd();">Add</button></td>
			<th class="err">%%ERR%%</th>
		</tr>
		<tr><td id="evts" class="dirlist" colspan="4"></td><td></td></tr>
	</table>
</body>
</html>